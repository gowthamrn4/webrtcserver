(this.webpackJsonprooms=this.webpackJsonprooms||[]).push([[0],{102:function(e,t,a){},103:function(e,t,a){},105:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHUAAAAyCAYAAABiWZRoAAAGBUlEQVR4nO2cT0zbVhzHv8UhMYkTxQyGU6qyNG21sEmpIrXSiNRDLkitpmnlsg6JHpi0id166G3VhnYZ6nqphrRDD2PrbemtaPSAdik7TAOiTWNb60aMIhuRLiw4xqFxs0Ow6yQOMYwk1HqfE9jPX7/3+74/v+ckPlIsFmHknc9/yYHwUuMwOeZuei0IB0pbqytAOHiIqTaEmGpDHOc++LYsMQq81t+quhAOCAdIYmQ7yPRrQ4ipNoSYakOIqTaEmGpDiKk2hJhqQ4ipNoSYakOIqTaEmGpDiKk2hJhqQ4ipNoSYakOIqTaEmGpDiKk2hJhqQ4ipNoSYakOIqTbE7Lc0AIBYmAUAPFjKAAAYmkKsn0WP3wUA4AVZP7cfQgE3OL8LoUDpG6prG3k8EmTwgrxvzUZpV8ZCu8eZoA8emgIvyEimspAUVT/P0BRCAQ9OBtzo8bvAizkkU5sQM/l9t4tjXYgEvejxu8DQDkhKAbwggxflMt2apl4bOgEA+PCr3xAJejESPwaGpsrK8IKM63f+KmtMPRiawtjFPj1QlfCCjIm7j/fV+EZpa7G4ensJOUXFZ++fAse6qspdv/MQyVQWkaAP14ZOVMSrCwAwNbuKxJy4p/vXaxdQ6nCT95YhKSqo3ui7nxpPev3dAIDL548CAJyONlw+fxTbhSKWViTkFBWd3nYAQKe3HRzrsjxiOdaFWx+9gZM7I0hSVCytSOBFGU5HG5gOBzq97Xj73KtYWVewklYsN7yR2losJEXF2MU+dHrbISkqfn74r64NAGdP+5FTChi72AeGpvQyzwpFPWaRoA9LKzmsbVjrWAxNYXz4NCJBX1W7MtIzMB0OOB1tON7dgViYxY+/Pq09UjUGo11VPdzYE2NhFhzrstT7xy4c13vvzHwak9PLZeeHBjiMxHsBACPx3qoprVXaRg0AmJxexsx82nDvPgxGu0oj6kIfACAxJ2JqdtX0/lfivbh6O2vpnrF+Vl9GzNoFlGYSzYdI0GctUfpmdrXMtGQqi7uGKSTE1f/lRizM6r0tmcqaVi4xJ+pTE8e6cGkniK3UNtMxGgoAU7NPyv5PprJlhmrXaTHUTLJCiPPof88srNesk0asn61vqqSoSKaqe9Wi4RjTQVWdr0QLeqkSazXLGTvLGcM1rdKu5P5CuuqYpKhlo77SdA3jlGu2Jtdjt1xh+MYihm8sYvLecv3pV9oqmFcwk8dE4nFJVKyfVXKs01CJ2m8gkBQVYiYPjnWhx2LDG6ltdr0Za5k8mJ0RaDYItOs1PHT9gQAAvJiDlmQNDXCIhVk8WMpUZdxG7bqm5mqsO5Ki7mlLo22FKnu1GWsbpcAzNGVpvW6kdtm1Fsvuda3ejZn5NCJBnz5KOdalr+1AaZQuprK4v5DW29K0hw9ahlhr5BvZa1AaqX0YmEg8xvU7D0332aGAG0MDHL7++E3d7Loj9aCQtgr66KgH539RxpJRDdQ+LCRTWVy9nS17qBEJehEKePSsfyTeCw9NNc9UXpT1oNeb9rT1xsp02mjtw4aWuCZTWSTmRDA0hZH4MQxGS+vuYLS7edOvMdCRoLdmuVDArRu0W9LTLO1WwtAUbo6GcXM0rO9xK5EUFZPTy3oHZWiqeaYak6pLb3FVjxw1rhgqbzURa6R2K5EUFT1s6Rn2YLS7ZruM8ILcPFN5QS7b/H85GkYk6ANDUzvrhBs3d44BpTWk1n6vmdqt5sHvLz5QGR8+jViY1c3VnuiND5/Sjz0S5OatqUBp88+xLv2R1vjwKdNyvCBjcvrvQ6PdSu7+JIJjnYgEfQgF3PqHC2bwgoyp2SfVphaLz8v/R7Hq2H7Z3HqOL75/hFh/J67Ej1Vlq2Imj5n5dSTmhEOlrbFbLIp48Y7HmvEyvgeyaC2uwj9b+OS7PzE0EMBgtNs0w1/byBfvL6QLP8ynC5KiFo+cHZ0qmmg1Ba/bid7uUmKzur6JTXn7pdBuNa/3vQKfx4lsbhur65uYvfXeEeP5pk6/lWzK2/hj+elLp91qKttV+SZY8nUWG0JMtSEOAP//S0GEQ8V/rEYT9YXCo8UAAAAASUVORK5CYII="},110:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(47),s=a.n(r),c=a(6),i=a(21).create({baseURL:"https://mywebrtcserver.herokuapp.com/"}),l=a(48),u=a(2),m=a(3),p=a(5),d=a(4),h=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(u.a)(this,a),t.call(this,e)}return Object(m.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"flash "+this.props.data.status},Array.isArray(this.props.data.messages)&&this.props.data.messages.map((function(e){return o.a.createElement("p",null,"- ",e)})),!Array.isArray(this.props.data.messages)&&o.a.createElement("p",null,this.props.data.messages))}}]),a}(o.a.Component);function f(e){return o.a.createElement("div",{className:"col-12"},o.a.createElement("h1",null,"Create Virtual Rooms and start casting media for",o.a.createElement("br",null)," others."),o.a.createElement("div",{className:"action"},o.a.createElement("a",{onClick:function(){e.showSignup(1)},className:"button green",href:"#"},"Sign Up"),o.a.createElement("span",null,"or"),o.a.createElement("a",{onClick:function(){e.showLogin(1)},className:"login",href:"#"},"Login")))}var v=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).handleUsername=function(e){var t=e.target.value;n.setState({username:t})},n.handlePassword=function(e){var t=e.target.value;n.setState({password:t})},n.handleSubmit=function(e){var t=!1,a=[];""==n.state.username&&a.push("Please Enter your Username \n"),""==n.state.password&&a.push("Please Enter your Password"),0==a.length?i.post("/auth/login",{username:n.state.username,password:n.state.password}).then((function(e){console.log(e),n.props.flashHandler("success","Logged In!");var t=function(e,t,a){var n={id:a,username:e,token:t};return localStorage.setItem("userData",JSON.stringify(n)),i.interceptors.request.use((function(e){return e.headers.token=t,e}),(function(e){return Promise.reject(e)}))}(n.state.username,e.data.data.token,e.data.data.id);n.props.setInterceptorID(t),n.props.showLogin(0),n.props.setUsername(n.state.username),n.props.setLogin(1)})).catch((function(e){n.props.flashHandler("error","Wrong Credentials"),console.log(e),n.setState({submitActive:!0})})):(n.props.flashHandler("error",a),t=!0),n.setState({submitActive:t})},n.state={username:"",password:"",submitActive:!0},n}return Object(m.a)(a,[{key:"render",value:function(){var e,t=this;return e=this.state.submitActive?"button blue":"button blue disabled",o.a.createElement("div",null,o.a.createElement("div",{className:"box"},o.a.createElement("h2",null,"Login"),o.a.createElement("input",{onChange:function(e){t.handleUsername(e)},type:"text",placeholder:"Please Enter your username",name:"username",style:{color:"black",width:"100%"}}),o.a.createElement("input",{onChange:function(e){t.handlePassword(e)},type:"password",placeholder:"Please Enter your password",name:"password",style:{color:"black",width:"100%"}}),o.a.createElement("a",{onClick:function(e){t.state.submitActive&&t.handleSubmit()},className:e,href:"#"},"Login")),o.a.createElement("div",{onClick:function(){t.props.showLogin(0)},className:"overlay"}))}}]),a}(o.a.Component),g=a(13),b=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).inputHandler=function(e){var t=e.target.name,a=e.target.value;n.setState(Object(g.a)({},t,a))},n.handleSubmit=function(e){var t=!1,a=[];""==n.state.username&&a.push("Please Enter your Username \n"),""==n.state.password&&a.push("Please Enter your Password \n"),""==n.state.email?a.push("Please Enter your email\n"):n.state.email.match(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)||a.push("The Email you entered is invalid\n"),""==n.state.password_confirm?a.push("Please enter your password confirmation\n"):n.state.password!=n.state.password_confirm&&a.push("The Passwords you entered do not match\n"),0==a.length?i.post("/users",{username:n.state.username,email:n.state.email,password:n.state.password}).then((function(e){n.props.flashHandler("success","Signed Up Succesfully!"),n.props.showSignup(0),n.props.showLogin(1)})).catch((function(e){n.props.flashHandler("error","An Error Occured!")})):(n.props.flashHandler("error",a),t=!0),n.setState({submitActive:t})},n.state={username:"",email:"",password:"",password_confirm:"",submitActive:!0},n}return Object(m.a)(a,[{key:"render",value:function(){var e,t=this;return e=this.state.submitActive?"button blue":"button blue disabled",o.a.createElement("div",null,o.a.createElement("div",{className:"box"},o.a.createElement("h2",null,"Sign Up"),o.a.createElement("input",{onChange:function(e){t.inputHandler(e)},type:"text",placeholder:"Please Enter your username",name:"username"}),o.a.createElement("input",{onChange:function(e){t.inputHandler(e)},type:"text",placeholder:"Please Enter your email address",name:"email"}),o.a.createElement("input",{onChange:function(e){t.inputHandler(e)},type:"password",placeholder:"Please Enter your password",name:"password"}),o.a.createElement("input",{onChange:function(e){t.inputHandler(e)},type:"password",placeholder:"Please Confirm your password",name:"password_confirm"}),o.a.createElement("a",{onClick:function(){t.handleSubmit()},className:e,href:"#"},"Sign Up")),o.a.createElement("div",{onClick:function(){t.props.showSignup(0)},className:"overlay"}))}}]),a}(o.a.Component),E=a(49),y=a.n(E),k=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).inviteHandler=function(){navigator.clipboard.writeText(n.props.room_code),n.props.flashHandler("success","Copied Room Code to Clipboard!")},n.leaveHandler=function(){n.state.socket.close(),n.props.setInsideRoom(0),n.props.flashHandler("error","You Left the room.")},n.fileUploadBox=function(){1!=n.state.people_count&&n.setState({upload_visible:!n.state.upload_visible})},n.handleUploadedFile=function(e,t){var a=e[0],o=a.type,r=window.URL||window.webkitURL,s=n.myRef.current.canPlayType(o);""===s&&(s="no");if("no"===s)return n.props.flashHandler("error","This file cannot be played."),void(t.target.value="");n.setState({upload_visible:!1}),n.myRef.current.src=r.createObjectURL(a)},n.videoPlayed=function(e){if("host"==n.props.type){if(console.log("video played"),n.myRef.current.captureStream())var t=n.myRef.current.captureStream();else if(n.myRef.current.mozCaptureStream())t=n.myRef.current.mozCaptureStream();var a={room_code:n.props.room_code};n.setState({stream:t}),n.state.socket.emit("stream",a)}},n.shareScreen=function(){1!=n.state.people_count&&(navigator.mediaDevices.getDisplayMedia?navigator.mediaDevices.getDisplayMedia({video:1}).then((function(e){n.setState({upload_visible:!1,sharing_screen:!0}),n.myRef.current.srcObject=e,n.myRef.current.play(),n.state.socket.emit("stream",{room_code:n.props.room_code})})).catch((function(e){n.props.flashHandler("error","No permissions granted for screen sharing!")})):n.props.flashHandler("error","Your browser doesn't support screen sharing"))},n.stopSharing=function(){n.myRef.current.srcObject.getTracks().forEach((function(e){return e.stop()})),n.myRef.current.srcObject=null,n.setState({sharing_screen:!1})},n.state={socket:"",sharing_screen:!1,people_count:1,upload_visible:!1,viewing:!1,WebRTC_config:{iceServers:[{urls:["stun:stun.l.google.com:19302"]}]},peerConnections:[]},n.myRef=o.a.createRef(),n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;"host"!=this.props.type&&this.setState({people_count:2}),this.setState({socket:y()("https://mywebrtcserver.herokuapp.com/")},(function(){var t,a=[],n={room_code:e.props.room_code};("host"==e.props.type?e.state.socket.emit("create-room",n):e.state.socket.emit("join-room",n),e.state.socket.on("user-joined",(function(){e.props.flashHandler("success","Someone Joined!"),e.setState({people_count:2})})),e.state.socket.on("user-left",(function(){e.props.flashHandler("error","Someone Left."),e.setState({people_count:1})})),e.state.socket.on("room-terminated",(function(){e.props.flashHandler("error","Host left the room."),e.props.setInsideRoom(0)})),"host"==e.props.type)?(e.state.socket.on("viewing",(function(t){var n=new RTCPeerConnection(e.state.WebRTC_config);a[t]=n,e.state.stream.getTracks().forEach((function(t){return n.addTrack(t,e.state.stream)})),n.onicecandidate=function(a){a.candidate&&e.state.socket.emit("candidate",t,a.candidate)},console.log("Creating offer"),n.createOffer().then((function(e){return n.setLocalDescription(e)})).then((function(){e.state.socket.emit("offer",t,n.localDescription)}))})),e.state.socket.on("answer",(function(e,t){a[e].setRemoteDescription(t)})),e.state.socket.on("candidate",(function(e,t){a[e].addIceCandidate(new RTCIceCandidate(t))})),e.state.socket.on("disconnectPeer",(function(e){a[e].close(),delete a[e]}))):(e.state.socket.on("offer",(function(a,n){(t=new RTCPeerConnection(e.state.WebRTC_config)).setRemoteDescription(n).then((function(){return t.createAnswer()})).then((function(e){return t.setLocalDescription(e)})).then((function(){e.state.socket.emit("answer",a,t.localDescription)})).then((function(){console.log(t.getStats())})),t.ontrack=function(t){e.setState({viewing:!0}),e.myRef.current.srcObject=t.streams[0],e.myRef.current.play()},t.onicecandidate=function(t){t.candidate&&e.state.socket.emit("candidate",a,t.candidate)}})),e.state.socket.on("candidate",(function(e,a){t.addIceCandidate(new RTCIceCandidate(a)).catch((function(e){return console.error(e)}))})),e.state.socket.on("stream",(function(t){e.state.socket.emit("view",t)})),e.state.socket.on("disconnectPeer",(function(){t.close()})))}))}},{key:"render",value:function(){var e=this;return 0==this.state.sharing_screen?o.a.createElement("a",{className:1==this.state.people_count?"disabled":"",onClick:function(t){e.shareScreen()},href:"#"},"Share Screen"):o.a.createElement("a",{onClick:function(t){e.stopSharing()},href:"#"},"Stop Screen"),o.a.createElement(o.a.Fragment,null,1==this.state.upload_visible&&o.a.createElement("div",{className:"upload_box"},o.a.createElement("input",{onChange:function(t){e.handleUploadedFile(t.target.files,t)},type:"file",accept:"video/*,audio/*"})),0==this.state.viewing&&"client"==this.props.type&&o.a.createElement("div",{className:"no-video"},o.a.createElement("p",null,"The Host hasn't streamed anything yet!")),o.a.createElement("div",{className:"col-12"},o.a.createElement("video",{onPlay:function(t){e.videoPlayed(t)},ref:this.myRef,width:"933",height:"360",controls:!0}),o.a.createElement("div",{className:"video_controls"},"host"==this.props.type&&o.a.createElement(o.a.Fragment,null,o.a.createElement("a",{className:1==this.state.people_count?"disabled":"",onClick:function(){e.fileUploadBox()},href:"#"},"Upload"),o.a.createElement("a",{onClick:function(){e.inviteHandler()},href:"#"},"Invite")),o.a.createElement("a",{onClick:function(){e.leaveHandler()},style:{color:"#ff6e6e"},href:"#"},"Leave"),o.a.createElement("div",{className:"participants"},o.a.createElement("span",null,"People: ",this.state.people_count)))))}}]),a}(o.a.Component),w=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).inputHandler=function(e){var t=e.target.name,a=e.target.value;n.setState(Object(g.a)({},t,a))},n.createRoom=function(){if(""!=n.state.room_name){var e=JSON.parse(localStorage.getItem("userData")).id;i.post("/rooms/create",{name:n.state.room_name,creatorId:e}).then((function(e){console.log(e.data.data.roomCode),n.setState({type:"host",room_code:e.data.data.roomCode}),n.props.flashHandler("success","Room Joined!"),n.props.setInsideRoom(1)})).catch((function(e){console.log(e),n.props.flashHandler("error","An Error occured")}))}else n.props.flashHandler("error","You didn't enter a room name!")},n.joinRoom=function(){""!=n.state.room_code?i.get("/rooms/join/"+n.state.room_code,{}).then((function(e){n.props.flashHandler("success","Room Joined!"),n.setState({room_name:e.data.data.room_name,type:"client"}),n.props.setInsideRoom(1)})).catch((function(e){n.props.flashHandler("error","Room is full!")})):n.props.flashHandler("error","You didn't enter a room code!")},n.state={room_name:"",room_code:"",type:"client"},n}return Object(m.a)(a,[{key:"render",value:function(){var e,t=this;return e=this.props.insideRoom?o.a.createElement(k,{setInsideRoom:this.props.setInsideRoom,flashHandler:this.props.flashHandler,type:this.state.type,room_name:this.state.room_name,room_code:this.state.room_code}):o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"col-12 col-sm-12 col-lg-6"},o.a.createElement("h3",null,"Create a Room"),o.a.createElement("div",{className:"room_action"},o.a.createElement("input",{onChange:function(e){t.inputHandler(e)},type:"text",name:"room_name",placeholder:"Enter Room Name"}),o.a.createElement("a",{className:"linkNoUnderline",onClick:function(){t.createRoom()},href:"#"},"Create & Join"))),o.a.createElement("div",{className:"col-12 col-sm-12 col-lg-6"},o.a.createElement("h3",null,"Join a Room"),o.a.createElement("div",{className:"room_action"},o.a.createElement("input",{onChange:function(e){t.inputHandler(e)},type:"text",name:"room_code",placeholder:"Enter Room code (e.g RG34WEZ)"}),o.a.createElement("a",{className:"linkNoUnderline",onClick:function(){t.joinRoom()},href:"#"},"Join")))),o.a.createElement(o.a.Fragment,null,e)}}]),a}(o.a.Component);a(102),a(103),a(104),a(105),a(106),a(107);var S=function(){var e=Object(n.useState)(0),t=Object(c.a)(e,2),a=t[0],r=t[1],s=Object(n.useState)(0),u=Object(c.a)(s,2),m=u[0],p=u[1],d=Object(n.useState)(0),g=Object(c.a)(d,2),E=g[0],y=g[1],k=Object(n.useState)("username"),S=Object(c.a)(k,2),C=S[0],O=S[1],A=Object(n.useState)(0),j=Object(c.a)(A,2),R=j[0],H=j[1],P=Object(n.useState)(0),N=Object(c.a)(P,2),L=N[0],U=N[1],T=Object(n.useState)({}),x=Object(c.a)(T,2),I=x[0],_=x[1],q=Object(n.useState)(0),Y=Object(c.a)(q,2),D=Y[0],G=Y[1];Object(n.useEffect)((function(){if(Object(l.loadProgressBar)({},i),localStorage.getItem("userData")){var e=JSON.parse(localStorage.getItem("userData"));y(1),i.interceptors.request.use((function(t){return t.headers.token=e.token,t}),(function(e){return Promise.reject(e)})),O(e.username)}}),[]);var J,K=function(){!function(e){localStorage.removeItem("userData"),i.interceptors.request.eject(e)}(D),V("success","Logged out succesfully!"),y(0)},V=function(e,t){U(1),_({status:e,messages:t}),setTimeout((function(){U(0)}),2e3)};return J=E?o.a.createElement(w,{flashHandler:V,setInsideRoom:H,insideRoom:R}):o.a.createElement(f,{showLogin:r,showSignup:p}),R||o.a.createElement("a",{onClick:function(){K()},className:"button red",href:"#"},"Logout"),o.a.createElement(o.a.Fragment,null,1==L&&o.a.createElement(h,{data:I}),1==a&&o.a.createElement(v,{setInterceptorID:G,flashHandler:V,showLogin:r,setUsername:O,setLogin:y}),1==m&&o.a.createElement(b,{flashHandler:V,showSignup:p,showLogin:r}),o.a.createElement("div",{className:"container-md homepage"},o.a.createElement("nav",{class:"navbar navbar-expand-lg navbar-dark bg-dark fixed-top"},o.a.createElement("a",{class:"navbar-brand",href:"index.html"},"ShareOne"),o.a.createElement("button",{class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarCollapse","aria-controls":"navbarCollapse","aria-expanded":"false","aria-label":"Toggle navigation"},o.a.createElement("span",{class:"navbar-toggler-icon"})),o.a.createElement("div",{class:"collapse navbar-collapse bg-dark",id:"navbarCollapse"},o.a.createElement("ul",{class:"navbar-nav ml-auto"},E?o.a.createElement("li",{class:"nav-item dropdown"},o.a.createElement("a",{class:"nav-link dropdown-toggle",href:"#",id:"navbardrop","data-toggle":"dropdown"},C),o.a.createElement("div",{class:"dropdown-menu"},o.a.createElement("a",{class:"dropdown-item",onClick:function(){K()}},"Logout"))):null))),o.a.createElement("div",{className:"row"},J)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},50:function(e,t,a){e.exports=a(110)},99:function(e,t){}},[[50,1,2]]]);
//# sourceMappingURL=main.c32c2c3f.chunk.js.map